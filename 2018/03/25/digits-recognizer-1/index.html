<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Today’s topic is like an introduction into the combination of computer vision and machine learning. All that I’ll do here is just fitting kNN model with the data of handwritten digits taken from the M">
<meta property="og:type" content="article">
<meta property="og:title" content="Digits Recognizer using Python and React. Train the model.">
<meta property="og:url" content="https://attractor-software.github.io/2018/03/25/digits-recognizer-1/index.html">
<meta property="og:site_name" content="Attractor Software Blog">
<meta property="og:description" content="Today’s topic is like an introduction into the combination of computer vision and machine learning. All that I’ll do here is just fitting kNN model with the data of handwritten digits taken from the M">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://attractor-software.github.io/blog/2018/03/25/digits-recognizer-1/find-best-k.jpg">
<meta property="og:image" content="https://attractor-software.github.io/blog/2018/03/25/digits-recognizer-1/classification-score.png">
<meta property="og:updated_time" content="2018-03-30T07:02:26.411Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Digits Recognizer using Python and React. Train the model.">
<meta name="twitter:description" content="Today’s topic is like an introduction into the combination of computer vision and machine learning. All that I’ll do here is just fitting kNN model with the data of handwritten digits taken from the M">
<meta name="twitter:image" content="https://attractor-software.github.io/blog/2018/03/25/digits-recognizer-1/find-best-k.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/blog/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/blog/images/favicon.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/favicon.ico">
          
        
    
    <!-- title -->
    <title>Digits Recognizer using Python and React. Train the model.</title>
    <!-- styles -->
    <link rel="stylesheet" href="/blog/css/style.css">
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="https://attractor-software.com/">About</a></li>
         
          <li><a href="https://github.com/AttractorSoftware">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/2018/03/26/digits-recognizer-2/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&text=Digits Recognizer using Python and React. Train the model."><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&is_video=false&description=Digits Recognizer using Python and React. Train the model."><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Digits Recognizer using Python and React. Train the model.&body=Check out this article: https://attractor-software.github.io/2018/03/25/digits-recognizer-1/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&name=Digits Recognizer using Python and React. Train the model.&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Set-up-environment"><span class="toc-number">1.</span> <span class="toc-text">Set up environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Import-dependencies"><span class="toc-number">2.</span> <span class="toc-text">Import dependencies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prepare-data"><span class="toc-number">3.</span> <span class="toc-text">Prepare data</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Load-data"><span class="toc-number">3.1.</span> <span class="toc-text">Load data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Split-the-data"><span class="toc-number">3.2.</span> <span class="toc-text">Split the data</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fit-the-model"><span class="toc-number">4.</span> <span class="toc-text">Fit the model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Find-best-k"><span class="toc-number">4.1.</span> <span class="toc-text">Find best k</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Evaluate-the-model-on-the-test-data"><span class="toc-number">4.2.</span> <span class="toc-text">Evaluate the model on the test data</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#To-be-continued"><span class="toc-number"></span> <span class="toc-text">To be continued</span></a>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Digits Recognizer using Python and React. Train the model.
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Teimur Gasanov</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-03-25T08:02:19.000Z" itemprop="datePublished">2018-03-25</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Today’s topic is like an introduction into the combination of computer vision and machine learning. All that I’ll do here is just fitting kNN model with the data of handwritten digits taken from the <a href="http://yann.lecun.com/exdb/mnist/" target="_blank" rel="noopener">MNIST Database</a> and also checking its accuracy. </p>
<h2 id="Set-up-environment"><a href="#Set-up-environment" class="headerlink" title="Set up environment"></a>Set up environment</h2><p>I’ll be using <a href="https://anaconda.org/anaconda/python" target="_blank" rel="noopener">Anaconda</a> as my environment so I’ll skip the step about installing the dependencies.</p>
<h2 id="Import-dependencies"><a href="#Import-dependencies" class="headerlink" title="Import dependencies"></a>Import dependencies</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cv2</span><br></pre></td></tr></table></figure>
<h2 id="Prepare-data"><a href="#Prepare-data" class="headerlink" title="Prepare data"></a>Prepare data</h2><h3 id="Load-data"><a href="#Load-data" class="headerlink" title="Load data"></a>Load data</h3><p>The dataset from <a href="http://yann.lecun.com/exdb/mnist/" target="_blank" rel="noopener">MNIST Database</a> is available in the datasets module of sklearn, so let’s start with loading the data.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">digits = datasets.load_digits()</span><br></pre></td></tr></table></figure></p>
<h3 id="Split-the-data"><a href="#Split-the-data" class="headerlink" title="Split the data"></a>Split the data</h3><p>Now we need to have two different datasets: one for testing and the other for training our model.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(X_train, X_test, y_train, y_test) = train_test_split(</span><br><span class="line">    digits.data, digits.target, test_size=<span class="number">0.25</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h2 id="Fit-the-model"><a href="#Fit-the-model" class="headerlink" title="Fit the model"></a>Fit the model</h2><h3 id="Find-best-k"><a href="#Find-best-k" class="headerlink" title="Find best k"></a>Find best k</h3><p>We can’t take k out of our mind, so let’s train model and evaluate accuracy for different k.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ks = np.arange(<span class="number">2</span>, <span class="number">10</span>)</span><br><span class="line">scores = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> ks:</span><br><span class="line">    model = KNeighborsClassifier(n_neighbors=k)</span><br><span class="line">    score = cross_val_score(model, X_train, y_train, cv=<span class="number">5</span>)</span><br><span class="line">    score.mean()</span><br><span class="line">    scores.append(score.mean())</span><br><span class="line">plt.plot(scores, ks)</span><br><span class="line">plt.xlabel(<span class="string">'accuracy'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'k'</span>)</span><br></pre></td></tr></table></figure></p>
<p>As the output we can see such plot:</p>
<img src="/blog/2018/03/25/digits-recognizer-1/find-best-k.jpg">
<p>Looking at this chart we can understand that the best accuracy was reached when k was 3.<br>So from now, we’ll be using k=3 for our model.</p>
<h3 id="Evaluate-the-model-on-the-test-data"><a href="#Evaluate-the-model-on-the-test-data" class="headerlink" title="Evaluate the model on the test data"></a>Evaluate the model on the test data</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">z = model.predict(X_test)</span><br></pre></td></tr></table></figure>
<p>Let’s now create a classification report to see the accuracy<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(classification_report(y_test, z))</span><br></pre></td></tr></table></figure></p>
<img src="/blog/2018/03/25/digits-recognizer-1/classification-score.png">
<p>Amazing! We reached 99% accuracy!</p>
<h1 id="To-be-continued"><a href="#To-be-continued" class="headerlink" title="To be continued"></a>To be continued</h1><p>In the next article I’ll create a <a href="https://reactjs.org/" target="_blank" rel="noopener">React</a> Application to draw the digits in order to join it with the classifier into a web application.</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="https://attractor-software.com/">About</a></li>
         
          <li><a href="https://github.com/AttractorSoftware">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Set-up-environment"><span class="toc-number">1.</span> <span class="toc-text">Set up environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Import-dependencies"><span class="toc-number">2.</span> <span class="toc-text">Import dependencies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prepare-data"><span class="toc-number">3.</span> <span class="toc-text">Prepare data</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Load-data"><span class="toc-number">3.1.</span> <span class="toc-text">Load data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Split-the-data"><span class="toc-number">3.2.</span> <span class="toc-text">Split the data</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fit-the-model"><span class="toc-number">4.</span> <span class="toc-text">Fit the model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Find-best-k"><span class="toc-number">4.1.</span> <span class="toc-text">Find best k</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Evaluate-the-model-on-the-test-data"><span class="toc-number">4.2.</span> <span class="toc-text">Evaluate the model on the test data</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#To-be-continued"><span class="toc-number"></span> <span class="toc-text">To be continued</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&text=Digits Recognizer using Python and React. Train the model."><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&is_video=false&description=Digits Recognizer using Python and React. Train the model."><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Digits Recognizer using Python and React. Train the model.&body=Check out this article: https://attractor-software.github.io/2018/03/25/digits-recognizer-1/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&title=Digits Recognizer using Python and React. Train the model."><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://attractor-software.github.io/2018/03/25/digits-recognizer-1/&name=Digits Recognizer using Python and React. Train the model.&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Attractor Software LLC
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="https://attractor-software.com/">About</a></li>
         
          <li><a href="https://github.com/AttractorSoftware">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/blog/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/blog/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/blog/lib/jquery/jquery.min.js"></script>
<script src="/blog/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/blog/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


